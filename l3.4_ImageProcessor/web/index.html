<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Image Processor</title>
</head>
<body>
  <h1>Image Processor</h1>
  <form id="uploadForm">
    <input type="file" name="image" accept="image/*" required>
    <button type="submit">Загрузить</button>
  </form>

  <div id="gallery"></div>

  <script>
    const form = document.getElementById('uploadForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const resp = await fetch('/upload', { method: 'POST', body: formData });
      const data = await resp.json();
      alert('Изображение загружено, ID: ' + data.id);
    });

    async function loadImage(id) {
      const resp = await fetch(`/image/${id}`);
      if (resp.status === 202) {
        const data = await resp.json();
        alert(`Статус: ${data.status}`);
      } else if (resp.ok) {
        const blob = await resp.blob();
        const url = URL.createObjectURL(blob);
        const img = document.createElement('img');
        img.src = url;
        document.body.appendChild(img);
      }
    }
  </script>
</body>
</html>
